<!-- Cart Header -->
<div class="p-4 border-b">
  <h2 class="text-xl font-semibold">{{ 'SUMMARY.Title' | translate }}</h2>
</div>

<h3 class="text-lg font-semibold flex items-center gap-2 p-4">
  <mat-icon class="text-primary">event</mat-icon>
  {{ 'SUMMARY.TimeSlots.Title' | translate }}
</h3>

<div class="space-y-3  p-4">
  @for (info of entries(); track info.offer.id) {
    <mat-card
      appearance="outlined"
      class="!p-3">
      <div class="flex items-start gap-3">
        <!-- Priority Indicator -->
        <div class="flex-shrink-0 pt-1">
          @if (isPreferred(info)) {
            <mat-icon class="text-amber-500">star</mat-icon>
          } @else {
            <mat-icon class="opacity-30">star_outline</mat-icon>
          }
        </div>
        <!-- Content -->
        <div class="flex-1 min-w-0">
          <div class="flex items-start justify-between gap-2">
            <div class="flex-1">
              <div class="font-medium">{{ info.offer.start | date:'fullDate' }}</div>
              <div class="text-sm opacity-70 mt-1">
                {{ info.offer.start | date:'shortTime' }} - {{ info.offer.finish | date:'shortTime' }}
              </div>
              @if (isPreferred(info)) {
                <div class="text-xs text-amber-600 mt-1">
                  {{ 'CART.PreferredLabel' | translate }}
                </div>
              }
            </div>
          </div>
          <!-- Max Persons Info -->
          <div class="flex items-center gap-2 text-sm mt-2 text-on-surface-variant">
            <mat-icon class="text-base" inline>people</mat-icon>
            <span>{{ 'SUMMARY.TimeSlots.MaxPersons' | translate: {count: info.offer.maxPersons} }}</span>
          </div>
        </div>
      </div>
    </mat-card>
  }
</div>

<mat-divider></mat-divider>

<!-- Visitor Group Information -->

<h3 class="text-lg font-semibold flex items-center gap-2 p-4">
  <mat-icon class="text-primary">groups</mat-icon>
  {{ 'SUMMARY.VisitorInfo.Title' | translate }}
</h3>

<div class="grid grid-cols-1 md:grid-cols-2 gap-4 p-4">
  <div class="space-y-3">
    <div>
      <p class="text-sm text-on-surface-variant">{{ 'REQUEST.Form.Title.Label' | translate }}</p>
      <p class="font-medium">{{ visitorGroup().title }}</p>
    </div>

    <div>
      <p class="text-sm text-on-surface-variant">{{ 'REQUEST.Form.Size.Label' | translate }}</p>
      <p
        class="font-medium">{{ 'SUMMARY.VisitorInfo.PersonCount' | translate: {count: visitorGroup().size} }}</p>
    </div>

    <div>
      <p class="text-sm text-on-surface-variant">{{ 'SUMMARY.VisitorInfo.Type' | translate }}</p>
      <p class="font-medium">
        {{ (visitorGroup().isGroup ? 'SUMMARY.VisitorInfo.GroupBooking' : 'SUMMARY.VisitorInfo.IndividualBooking') | translate }}
      </p>
    </div>

    <div>
      <p class="text-sm text-on-surface-variant">{{ 'SUMMARY.VisitorInfo.AgeRange' | translate }}</p>
      <p class="font-medium">{{ visitorGroup().minAge }}
        - {{ visitorGroup().maxAge }} {{ 'SUMMARY.VisitorInfo.Years' | translate }}</p>
    </div>
  </div>

  <div class="space-y-3">
    <div>
      <p class="text-sm text-on-surface-variant">{{ 'REQUEST.Form.Contact.Label' | translate }}</p>
      <p class="font-medium">{{ visitorGroup().contact }}</p>
    </div>

    <div>
      <p class="text-sm text-on-surface-variant">{{ 'REQUEST.Form.Phone.Label' | translate }}</p>
      <p class="font-medium">{{ visitorGroup().phone }}</p>
    </div>

    <div>
      <p class="text-sm text-on-surface-variant">{{ 'REQUEST.Form.Mail.Label' | translate }}</p>
      <p class="font-medium">{{ visitorGroup().email }}</p>
    </div>
    <div>
      <p class="text-sm text-on-surface-variant">{{ 'SUMMARY.VisitorInfo.Address' | translate }}</p>
      <p class="font-medium">{{ address() }}</p>
    </div>
  </div>
</div>

@if (comment()) {
  <mat-divider></mat-divider>

  <!-- Comment Section -->
  <section>
    <h3 class="text-lg font-semibold mb-3 flex items-center gap-2 p-4">
      <mat-icon class="text-primary">comment</mat-icon>
      {{ 'REQUEST.Form.Comment.Label' | translate }}
    </h3>
    <div class="bg-surface-container rounded-lg p-4">
      <p class="text-sm whitespace-pre-wrap">{{ comment() }}</p>
    </div>
  </section>
}

<mat-divider></mat-divider>

<!-- Terms Confirmation -->

<div class="flex items-center gap-2 text-sm p-4">
  <mat-icon [class]="termsAccepted() ? 'text-primary' : 'text-error'">
    {{ termsAccepted() ? 'check_circle' : 'cancel' }}
  </mat-icon>
  <span [class]="termsAccepted() ? 'text-on-surface' : 'text-error'">
                {{ (termsAccepted() ? 'SUMMARY.Terms.Accepted' : 'SUMMARY.Terms.NotAccepted') | translate }}
              </span>
</div>


<div class="flex justify-between items-center p-4">
  <button mat-stroked-button (click)="edit.emit(request())">
    <mat-icon>edit</mat-icon>
    {{ 'SUMMARY.Action.Edit' | translate }}
  </button>
  <button mat-flat-button color="primary"
          [disabled]="!termsAccepted()"
          (click)="confirm.emit(request())">
    <mat-icon>check</mat-icon>
    {{ 'SUMMARY.Action.Confirm' | translate }}
  </button>
</div>
