<div>
  <div class="flex justify-between items-start p-4 ">
    <div class="flex-1">
      <!-- Header row -->
      <div class="flex items-center gap-2 mb-1">
        <div class="w-7 h-7 rounded border-gray-300 border bg-gray-50 flex justify-center items-center">
          <div class="text-base font-medium truncate text-gray-800">
            {{ data().info.offer.id }}
          </div>
        </div>
        <h3 class="text-lg font-bold"> {{ data().info.offer.start | date:'shortTime' }} Tour </h3>

        <!-- Edit color -->
        <button matIconButton (click)="toggleEditingColor()">
          <mat-icon>edit</mat-icon>
        </button>

        <!-- Collapse toggle -->
        <button matIconButton class="ml-auto"
                (click)="toggleShowCollapse()">
          <mat-icon>
            {{ collapsed() ? 'expand_more' : 'expand_less' }}
          </mat-icon>
        </button>
      </div>

      <!-- Time slot -->
      <div class="flex items-center gap-2 text-sm">
        <mat-icon inline>schedule</mat-icon>
        <span>{{ data().info.offer.start | date:'shortTime' }}
          - {{ data().info.offer.finish | date:'shortTime' }}</span>
      </div>
    </div>

    <!-- Availability -->
    <div class="text-right">
      <div class="text-xl font-bold">
        {{ availableSpace() }}
      </div>
      <div class="text-xs">
        available
      </div>
    </div>
  </div>

  <!-- Guide selector -->
  <div class="flex items-center gap-2 text-sm cursor-pointer px-4" (click)="selectGuide()">
    <span>Guide:</span>
    <span>{{ data().info.guide?.firstName }} {{ data().info.guide?.lastName }}</span>
  </div>

  <div class="h-full">
    <div class="flex gap-4 text-xs px-4 py-3 bg-gray-100 border-b ">
      <div class="flex items-center gap-1">
        <mat-icon inline>group</mat-icon>
        <span class="text-gray-600">Total:</span>
        <span class="font-semibold text-gray-800">{{ data().info.offer.maxPersons }}</span>
      </div>
      <div class="flex items-center gap-1">
        <mat-icon class="text-green-600" inline>check_circle</mat-icon>
        <span class="text-gray-600">Confirmed:</span>
        <span class="font-semibold text-green-700">{{ bookedSpace() }}</span>
      </div>
      @if (reservedSpace()) {
        <div class="flex items-center gap-1">
          <mat-icon class="text-amber-600" inline>pending</mat-icon>
          <span class="text-gray-600">Pending:</span>
          <span class="font-semibold text-amber-700">{{ reservedSpace() }}</span>
        </div>
      }
    </div>
    @if (!collapsed()) {

      <!-- Reservations List -->
      <div class="p-3 max-h-96 overflow-y-auto bg-gray-50 ">
        @if (reservations().length === 0) {
          <p class="text-gray-500 text-center py-3 text-sm">No reservations yet</p>
        } @else {
          <div class="flex flex-col gap-1">
            @for (reservation of reservations(); track reservation.reservationId) {
              <app-dashboard-content-entry-reservation [reservation]="reservation"/>
            }
          </div>
        }
      </div>
    }
  </div>
</div>
