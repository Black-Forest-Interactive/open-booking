<div class="flex flex-col h-[calc(100vh-120px)] min-h-0">

  <!-- Loading -->
  <app-loading-bar [reloading]="reloading()"></app-loading-bar>

  <!-- Header -->
  <mat-toolbar color="primary" class="shadow-sm">
    <mat-toolbar-row class="container mx-auto !px-4 !py-3 gap-3 flex-wrap !h-auto !min-h-fit">
      <span class="text-xl font-semibold flex-1">
        {{ 'OFFER.Title' | translate }}
      </span>

      <div class="flex flex-wrap gap-3">
        <button mat-fab extended color="primary" routerLink="./create">
          <mat-icon>add</mat-icon>
          {{ 'OFFER.Action.CreateSingle' | translate }}
        </button>

        <button mat-fab extended routerLink="./create/series">
          <mat-icon>playlist_add</mat-icon>
          {{ 'OFFER.Action.CreateSeries' | translate }}
        </button>

        <button mat-fab extended routerLink="./create/range">
          <mat-icon>format_list_bulleted_add</mat-icon>
          {{ 'OFFER.Action.CreateRange' | translate }}
        </button>
      </div>
    </mat-toolbar-row>
  </mat-toolbar>

  <!-- Filters section below toolbar -->
  <div class="shadow-sm border-b">
    <div class="container mx-auto px-4 py-4">
      <div class="flex flex-wrap items-center gap-4">

        <mat-form-field class="flex-1 min-w-[300px]" subscriptSizing="dynamic" appearance="fill">
          <mat-label>{{ 'DAY_INFO.SelectRange.Title' | translate }}</mat-label>
          <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
            <input matStartDate formControlName="start"
                   placeholder="{{ 'DAY_INFO.SelectRange.StartDate' | translate }}">
            <input matEndDate formControlName="end" placeholder="{{ 'DAY_INFO.SelectRange.EndDate' | translate }}">
          </mat-date-range-input>
          <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-date-range-picker #picker></mat-date-range-picker>

          @if (range.controls.start.hasError('matStartDateInvalid')) {
            <mat-error>Invalid start date</mat-error>
          }
          @if (range.controls.end.hasError('matEndDateInvalid')) {
            <mat-error>Invalid end date</mat-error>
          }
        </mat-form-field>

        @if (range.valid) {
          <button
            mat-icon-button
            (click)="clearSelection()"
            color="warn"
            matTooltip="{{ 'OFFER.Action.ClearFilter' | translate }}">
            <mat-icon>close</mat-icon>
          </button>
        }

        <div class="flex-1"></div>

        <!-- Summary info -->
        <div class="text-sm font-medium self-center opacity-70">
          {{ 'OFFER.Info.TotalOffers' | translate }}:
          <span class="font-semibold opacity-100">{{ totalElements() }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- âœ… SCROLL AREA -->
  <div class="flex-1 overflow-auto min-h-0">
    <div class="container mx-auto py-4">
      <app-offer-content
        [entries]="offer()"
        [reloading]="reloading()"
        (edit)="handleEdit($event)"
        (delete)="handleDelete($event)">
      </app-offer-content>

      @if (offer().length === 0 && !reloading()) {
        <div class="py-20 text-center">
          <div class="inline-flex items-center justify-center w-24 h-24 rounded-full mb-6">
            <mat-icon class="!w-16 !h-16 !text-6xl opacity-50" color="primary">inbox</mat-icon>
          </div>
          <h3 class="text-xl font-semibold mb-2">
            {{ 'OFFER.Empty.Title' | translate }}
          </h3>
          <p class="opacity-70 mb-8 max-w-md mx-auto">
            {{ 'OFFER.Empty.Description' | translate }}
          </p>
          <button mat-fab extended color="primary" routerLink="./create">
            <mat-icon>add</mat-icon>
            {{ 'OFFER.Action.CreateFirst' | translate }}
          </button>
        </div>
      }
    </div>
  </div>


  <!-- Paginator -->
  <div class="border-t">
    <mat-paginator
      [length]="totalElements()"
      [pageSize]="pageSize()"
      [pageIndex]="pageNumber()"
      [pageSizeOptions]="[10, 25, 50, 100]"
      [showFirstLastButtons]="true"
      [disabled]="reloading()"
      (page)="handlePageChange($event)">
    </mat-paginator>
  </div>
</div>
