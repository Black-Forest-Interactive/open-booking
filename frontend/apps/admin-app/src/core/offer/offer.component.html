<div class="flex flex-col h-[calc(100vh-120px)] min-h-0">

  <!-- Loading -->
  <app-loading-bar [reloading]="reloading()"></app-loading-bar>

  <!-- Header -->
  <mat-toolbar>
    <mat-toolbar-row class="gap-3 !bg-gray-700 text-gray-50">
      <span class="text-xl font-semibold flex-1">
        {{ 'OFFER.Title' | translate }}
      </span>

      <div class="flex flex-wrap gap-3">
        <button matButton="elevated" color="primary" routerLink="./create">
          <mat-icon>add</mat-icon>
          {{ 'OFFER.Action.CreateSingle' | translate }}
        </button>

        <button matButton="elevated" (click)="handleCreateSeries()">
          <mat-icon>playlist_add</mat-icon>
          {{ 'OFFER.Action.CreateSeries' | translate }}
        </button>

        <button matButton="elevated" (click)="handleCreateRange()">
          <mat-icon>format_list_bulleted_add</mat-icon>
          {{ 'OFFER.Action.CreateRange' | translate }}
        </button>

        <button matIconButton (click)="reload()">
          @if (reloading()) {
            <mat-spinner [diameter]="18"></mat-spinner>
          } @else {
            <mat-icon class="!text-gray-200">refresh</mat-icon>
          }
        </button>
      </div>
    </mat-toolbar-row>
    <mat-toolbar-row class="gap-3 border-gray-700 border ">
      <mat-form-field class="flex-1 min-w-[300px] dense-3" subscriptSizing="dynamic" appearance="fill">
        <mat-label>{{ 'DAY_INFO.SelectRange.Title' | translate }}</mat-label>
        <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
          <input matStartDate formControlName="start" placeholder="{{ 'DAY_INFO.SelectRange.StartDate' | translate }}">
          <input matEndDate formControlName="end" placeholder="{{ 'DAY_INFO.SelectRange.EndDate' | translate }}">
        </mat-date-range-input>
        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-date-range-picker #picker></mat-date-range-picker>
      </mat-form-field>

      @if (range.valid) {
        <button
          mat-icon-button
          (click)="clearSelection()"
          color="warn"
          matTooltip="{{ 'OFFER.Action.ClearFilter' | translate }}">
          <mat-icon>close</mat-icon>
        </button>
      }
    </mat-toolbar-row>
  </mat-toolbar>


  <!-- âœ… SCROLL AREA -->
  <div class="flex-1 overflow-auto min-h-0">
    <app-offer-content
      [entries]="offer()"
      [reloading]="reloading()"
      (edit)="handleEdit($event)"
      (delete)="handleDelete($event)"
      (toggleActive)="handleToggleActive($event)"
    >
    </app-offer-content>

    @if (offer().length === 0 && !reloading()) {
      <div class="py-20 text-center">
        <div class="inline-flex items-center justify-center w-24 h-24 rounded-full mb-6">
          <mat-icon class="!w-16 !h-16 !text-6xl opacity-50" color="primary">inbox</mat-icon>
        </div>
        <h3 class="text-xl font-semibold mb-2">
          {{ 'OFFER.Empty.Title' | translate }}
        </h3>
        <p class="opacity-70 mb-8 max-w-md mx-auto">
          {{ 'OFFER.Empty.Description' | translate }}
        </p>
        <button mat-fab extended color="primary" routerLink="./create">
          <mat-icon>add</mat-icon>
          {{ 'OFFER.Action.CreateFirst' | translate }}
        </button>
      </div>
    }
  </div>
</div>
