<mat-card class="shadow-sm hover:shadow-md transition-shadow" appearance="outlined">
  <!-- Card Header -->
  <div class="bg-gray-200 px-6 py-4 border-b border-gray-200 rounded-t-xl">
    <div class="flex justify-between">
      @if (showBackButton()) {
        <button matButton="outlined" (click)="back.emit(true)">
          <mat-icon>arrow_back_ios</mat-icon>
          {{ 'ACTION.Back' | translate }}
        </button>
      }
      <div class="flex items-center gap-3 flex-wrap">
        <app-reservation-status [data]="data().reservation"/>
        <app-visitor-status [visitor]="data().visitor"/>
        <app-visitor-type [data]="data().visitor" class="flex-shrink-0"/>
      </div>
    </div>
  </div>

  <!-- Card Content -->
  <div class="p-6">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- Visitor Information -->
      <div class="flex flex-col gap-2">
        <div class="space-y-3">
          <div class="flex gap-4 items-center">

            <app-visitor-title [data]="data().visitor" class="font-semibold text-gray-900"/>
            <app-visitor-size [visitor]="data().visitor"></app-visitor-size>
          </div>
          @if (data().visitor.description) {
            <div class="flex items-start gap-3">
              <div class="text-sm text-gray-600">{{ data().visitor.description }}</div>
            </div>
          }
          <div class="grid grid-cols-2 gap-3 text-sm">
            <div>
              <span class="text-gray-500">{{ 'RESERVATION.Form.Title.Label' | translate }}:</span>
              <span class="ml-2 font-medium text-gray-900 capitalize">{{ data().visitor.type }}</span>
            </div>
            <div>
                  <span class="text-gray-500">
                    {{ 'RESERVATION.Form.MinAge.Label' | translate }}
                    - {{ 'RESERVATION.Form.MaxAge.Label' | translate }}:
                  </span>
              <span class="ml-2 font-medium text-gray-900">                    {{ data().visitor.minAge }}
                -{{ data().visitor.maxAge }}                   </span>
            </div>
          </div>

          @if (data().reservation.comment) {
            <div class="p-3 bg-white/60 rounded-lg border border-gray-300">
              <div class="flex items-start gap-2">
                <mat-icon class="w-4 h-4 text-blue-600 mt-0.5">comment</mat-icon>
                <div class="flex-1">
                  <div class="text-xs font-medium text-gray-500 mb-1">
                    {{ 'RESERVATION.Form.Comment.Label' | translate }}
                  </div>
                  <p class="text-sm text-gray-700">{{ data().reservation.comment }}</p>
                </div>
              </div>
            </div>
          }

          <mat-divider></mat-divider>

          <div class="space-y-2">
            <div class="flex items-center gap-2 text-sm">
              <mat-icon class="text-gray-400" inline>phone</mat-icon>
              <span class="text-gray-500 min-w-[60px]">{{ 'RESERVATION.Form.Phone.Label' | translate }}:</span>
              <span class="text-gray-700">{{ data().visitor.phone }}</span>
            </div>
            <div class="flex items-center gap-2 text-sm">
              <mat-icon class="text-gray-400" inline>email</mat-icon>
              <span class="text-gray-500 min-w-[60px]">{{ 'RESERVATION.Form.Mail.Label' | translate }}:</span>
              <span class="text-gray-700">{{ data().visitor.email }}</span>
            </div>
            <div class="flex items-start gap-2 text-sm">
              <mat-icon class="text-gray-400" inline>location_on</mat-icon>
              <div class="flex-1 flex flex-col gap-2">
                <div class="text-gray-700">
                  <span class="text-gray-500">{{ 'RESERVATION.Form.Street.Label' | translate }}:</span>
                  {{ data().visitor.address.street }}
                </div>
                <div class="text-gray-700">
                  <span class="text-gray-500">{{ 'RESERVATION.Form.Zip.Label' | translate }}:</span>
                  {{ data().visitor.address.zip }},
                  <span class="text-gray-500">{{ 'RESERVATION.Form.City.Label' | translate }}:</span>
                  {{ data().visitor.address.city }}
                </div>
              </div>
            </div>
          </div>

          @if (data().visitor.verification.timestamp) {
            <mat-divider></mat-divider>
            <div class="text-xs text-gray-500">
              Verified on {{ data().visitor.verification.timestamp | date:'short' }}
            </div>
          }


        </div>

        <!-- Actions -->
        <div class="flex gap-2">
          <app-visitor-confirm [data]="data().visitor" (changed)="reload.emit($event)" class="flex-1"/>
          <button
            matButton="outlined"
            color="warn"
            [disabled]="data().reservation.status === ReservationStatus.DENIED"
            (click)="denyReservation()"
            class="flex-1">
            <mat-icon>cancel</mat-icon>
            {{ 'RESERVATION.Action.Deny' | translate }}
          </button>
        </div>

      </div>

      <!-- Offers & Actions -->
      <div class="flex flex-col justify-between">
        <div>
          <div class="flex items-center gap-2 mb-4">
            <mat-icon class="text-blue-600" inline>event</mat-icon>
            <h4 class="font-semibold text-gray-900">
              {{ 'RESERVATION.Offer.Title' | translate }}
            </h4>
          </div>

          <div class="flex flex-col gap-2">
            <app-reservation-content-entry-offer
              [entry]="data().offer"
              [visitor]="data().visitor"
              [reservation]="data().reservation"
              (confirm)="confirmOffer($event)"
            />
          </div>
        </div>
      </div>
      <div class="flex gap-2 text-xs text-gray-500 text-center">
        <div class="font-medium">{{ 'RESERVATION.Created' | translate }}</div>
        <div>{{ data().timestamp | date:'short' }}</div>
      </div>
    </div>
  </div>


</mat-card>
