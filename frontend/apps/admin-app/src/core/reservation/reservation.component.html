<app-main-content
  [title]="'MENU.Reservation' | translate"
  searchLabel="RESERVATION.Action.Search"
  [enableSearch]="true"
  (search)="handleSearch($event)"
>
  <div class="flex gap-2 flex-auto items-center" actions>
    <mat-slide-toggle [(ngModel)]="filter.onlyMailConfirmed">{{ 'BOOKING.Filter.MailConfirmed' |translate }}
    </mat-slide-toggle>
    <!-- Date Range Filter -->
    <mat-form-field class="flex-1 !min-w-128 dense-3" subscriptSizing="dynamic" appearance="outline">
      <mat-label>{{ 'DAY_INFO.SelectRange.Title' | translate }}</mat-label>
      <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
        <input matStartDate formControlName="start"
               placeholder="{{ 'DAY_INFO.SelectRange.StartDate' | translate }}">
        <input matEndDate formControlName="end" placeholder="{{ 'DAY_INFO.SelectRange.EndDate' | translate }}">
      </mat-date-range-input>
      <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-date-range-picker #picker></mat-date-range-picker>

      @if (range.controls.start.hasError('matStartDateInvalid')) {
        <mat-error>Invalid start date</mat-error>
      }
      @if (range.controls.end.hasError('matEndDateInvalid')) {
        <mat-error>Invalid end date</mat-error>
      }
    </mat-form-field>

    <!-- Clear Filters Button -->
    @if (filter.hasActiveFilters()) {
      <button
        mat-stroked-button
        color="primary"
        (click)="clearFilters()">
        <mat-icon>clear</mat-icon>
        Clear Filters
      </button>
    }

    <button matIconButton (click)="reload()">
      @if (filter.reloading()) {
        <mat-spinner [diameter]="18"></mat-spinner>
      } @else {
        <mat-icon class="!text-gray-800">refresh</mat-icon>
      }
    </button>
  </div>

  <app-reservation-content
    [entries]="filter.entries()"
    [reloading]="filter.reloading()"
    (reload)="reload()"
    [currentUserId]="authService.currentUserId() ?? ''"
    class="p-4"
  >
  </app-reservation-content>

  <!-- Paginator -->
  <mat-paginator
    [length]="filter.totalElements()"
    [pageSize]="filter.pageSize()"
    [pageIndex]="filter.pageNumber()"
    [pageSizeOptions]="[10, 25, 50, 100]"
    [showFirstLastButtons]="true"
    [disabled]="filter.reloading()"
    (page)="handlePageChange($event)">
  </mat-paginator>

</app-main-content>
